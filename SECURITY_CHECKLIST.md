# セキュリティチェックリスト

## 🚨 コミット前必須チェック項目

### API キー・認証情報
- [ ] 実際のAPIキーがコード内に直接記載されていない
- [ ] 実際のAPIキーが文書ファイル（.md）に記載されていない
- [ ] `.env`ファイルがコミット対象に含まれていない
- [ ] パスワード・トークンがハードコーディングされていない
- [ ] プライベートキーが含まれていない

### 設定ファイル
- [ ] 本番環境の設定が含まれていない
- [ ] データベース接続文字列に実際の認証情報が含まれていない
- [ ] サービスURLが本番環境の実際のURLでない

### 文書ファイル
- [ ] 文書内の例示値がプレースホルダーになっている
- [ ] 実際の認証情報を例として使用していない
- [ ] スクリーンショットに機密情報が写っていない

## 🔧 自動化されたチェック

以下は pre-commit フックで自動実行されます：

### 有効化されたチェック
- ✅ API キーパターン検出
- ✅ プライベートキー検出
- ✅ `.env`ファイル検出
- ✅ 高エントロピー文字列検出
- ✅ 基本認証情報検出

### フック実行コマンド
```bash
# 手動でセキュリティチェック実行
pre-commit run --all-files

# 特定のフックのみ実行
pre-commit run detect-secrets
pre-commit run check-api-keys
```

## 🚨 緊急時対応手順

### APIキー漏洩時
1. **即座にAPIキーを無効化/再生成**
2. 新しいAPIキーを安全に設定
3. 過去のコミット履歴からAPIキーを削除（git filter-branch等）
4. GitHubのSecurityタブでSecret scanningアラートを確認

### 対応コマンド例
```bash
# APIキーを含むコミットを履歴から削除（危険な操作）
git filter-branch --force --index-filter \
  'git rm --cached --ignore-unmatch FILENAME' \
  --prune-empty --tag-name-filter cat -- --all

# 強制プッシュ（注意：共有リポジトリでは慎重に）
git push origin --force --all
```

## 📋 定期メンテナンス

### 月次チェック
- [ ] `.gitignore` パターンの見直し
- [ ] 不要なファイルがリポジトリに含まれていないか確認
- [ ] APIキーのローテーション実施

### 新機能追加時
- [ ] 新しい環境変数は `.env.example` に追加
- [ ] 機密情報の取り扱い方針を確認
- [ ] テストデータに実際の認証情報を使用しない

## ⚙️ ツール設定

### pre-commit 設定ファイル
- 設定場所: `.pre-commit-config.yaml`
- ベースライン: `.secrets.baseline`

### カスタムフック
- API キー検出パターン: `AIza[0-9A-Za-z_-]{35}`
- 環境ファイル検出: `\.env$`

## 📞 緊急連絡先

セキュリティインシデント発生時の連絡手順：
1. APIプロバイダーでキー無効化
2. プロジェクト管理者への報告
3. 影響範囲の調査と対応策実施

---
**注意**: このチェックリストは参考ガイドです。プロジェクトの要件に応じて適宜カスタマイズしてください。
